# 3.5mm combojack

## Marcello, what is it?

New laptop and some desktop cases has combojack instead traditional splitted jacks.

## What you doin'?

Fixing combojack on my hackintosh

## Mammamia Marcello, this is not how to fix combojack on hackintosh

What you mean?

## This is how to fix combojack on hackintosh

## Requirements

* [CodecCommander](https://bitbucket.org/RehabMan/os-x-eapd-codec-commander/downloads/RehabMan-CodecCommander-2018-1003.zip)
  * includes hda-verb
* Codec name
  * from previous page [AppleALC](applealc.md)
* [Mount EFI](../bootloaders/mount-efi.md)
* Clover
  * AudioDxe.efi

### Step 1: installing Codec Commander and hda-verb

{% hint style="warning" %}
Starting from macOS Catalina 10.15, file system structure has changed and is splitted in two partitions: one for operating system which is read-only, and one for user data.

Mount the root partition in read and write mode with the following command:
{% endhint %}

```bash
sudo mount -uw /
```

Download Codec Commander kext and place it in `ECKO`. Then place `hda-verb` inside `/usr/bin`. Reboot and proceed to **Step 2**.

### Step 2: dumping codec from Clover

Download AudioDxe.efi and place it in `ECDU` or `ECDB` while in Clover boot screen press `F8` \(or `Fn+F8` if you have `Fn keys` swapped\)

Mount EFI and then open `ECM` . You'll find some .txt file. 

![](../.gitbook/assets/image%20%283%29.png)

### Step 3: analyze codec dump

![Codec name: Realtek ALC3254 aka ALC295](../.gitbook/assets/image%20%287%29.png)

By scrolling the txt file you'll find something as depicted below

![](../.gitbook/assets/image%20%286%29.png)

Example:

```text
Node 0x12 [Pin Complex] wcaps 0x40040b: Stereo Amp-In
  Control: name="Internal Mic Boost Volume", index=0, device=0
    ControlAmp: chs=3, dir=In, idx=0, ofs=0
  Amp-In caps: ofs=0x00, nsteps=0x03, stepsize=0x27, mute=0
  Amp-In vals:  [0x00 0x00]
  Pincap 0x00000020: IN
  Pin Default 0xb7a60130: [Fixed] Mic at Oth Mobile-In
    Conn = Digital, Color = Unknown
    DefAssociation = 0x3, Sequence = 0x0
    Misc = NO_PRESENCE
  Pin-ctls: 0x20: IN
  Power states:  D0 D1 D2 D3 EPSS
  Power: setting=D0, actual=D0
```

**Node: `0x12`  
Name:** `Internal Mic Boost Volume`  
**Pin-ctls:** `0x20` ****

Look for `Headset Mic Boost Volume` and note `Node` and `Pin-ctls`. 

For my ALC295 I have the following `Pin Complex`

```text
Node 0x19 [Pin Complex] wcaps 0x40048b: Stereo Amp-In
  Control: name="Headset Mic Boost Volume", index=0, device=0
    ControlAmp: chs=3, dir=In, idx=0, ofs=0
  Amp-In caps: ofs=0x00, nsteps=0x03, stepsize=0x27, mute=0
  Amp-In vals:  [0x00 0x00]
  Pincap 0x00003724: IN Detect
    Vref caps: HIZ 50 GRD 80 100
  Pin Default 0x411111f0: [N/A] Speaker at Ext Rear
    Conn = 1/8, Color = Black
    DefAssociation = 0xf, Sequence = 0x0
    Misc = NO_PRESENCE
  Pin-ctls: 0x24: IN VREF_80
  Unsolicited: tag=00, enabled=0
  Power states:  D0 D1 D2 D3 EPSS
  Power: setting=D0, actual=D0
```

What we need to to is telling to our audio codec that the Node `0x19` has `0x24` as Pin-ctls.

According to [hda\_verb.h](https://github.com/digitalocean/linux-coresched/blob/master/include/sound/hda_verbs.h), `AC_VERB_SET_PIN_WIDGET_CONTROL` can be shortened with `0x707`.

So inside a terminal window type

```text
hda-verb 0x19 0x707 0x24
```

You will notice that switching from speakers to headphone won't produce more white noise or distorted sound. Now let's make this fix permanent

### Step 4: creating the daemon



WIP

## Credits

* [https://osxlatitude.com/forums/topic/11316-how-to-fix-static-noisedistortioncrackling-sound-and-combo-jack-on-laptops/](https://osxlatitude.com/forums/topic/11316-how-to-fix-static-noisedistortioncrackling-sound-and-combo-jack-on-laptops/) for the guide
* RehabMan for CodecCommander

